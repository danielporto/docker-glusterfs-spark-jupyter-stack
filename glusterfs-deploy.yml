#!/usr/bin/ansible-playbook

- import_playbook: glusterfs-provision.yml

- hosts: gluster
  become: yes
  gather_facts: no
  any_errors_fatal: true

  vars_files:
    - vars.yaml

  tasks:
    - name: Upload dataset to GFS
      synchronize:
        src: "{{ dataset_path }}" 
        dest: "{{ gluster_mount_dir }}"
        checksum: yes
        times: no
      run_once: yes
      
    - name: Recursively change permissions of "{{gluster_mount_dir}}"
      file:
        path: "{{ gluster_mount_dir }}"
        mode: u=rw,g=rw,o=r
        recurse: yes
        owner: "{{ default_user }}"
        group: "{{ default_group }}"
      run_once: yes